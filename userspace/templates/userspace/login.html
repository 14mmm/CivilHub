{% extends 'places_core/base.html' %}
{% load staticfiles %}{% load i18n %}
{% block content %}
<div class="login-page">
    
    {% block require_scripts %}&nbsp;{% endblock %}

    {% if welcome_msg %}
        <p class="alert alert-success">{% blocktrans %}Thank you for registeration. You can now log in.{% endblocktrans %}</p>
    {% endif %}
    
    {% comment %}
    
        Testujemy Google+
        
    {% endcomment %}
    
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript">
            (function () {
                var po = document.createElement('script');
                po.type = 'text/javascript';
                po.async = true;
                po.src = 'https://plus.google.com/js/client:plusone.js?onload=start';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(po, s);
            })();
        </script>
        <script type="text/javascript">
            var signInCallback = function (result) {
                if (result['error']) {
                    //alert('An error happened:', result['error']);
                    console.log('An error happened:', result['error']);
                } else {
                    $('#code').attr('value', result['code']);
                    $('#at').attr('value', result['access_token']);
                    $('#google-plus').submit();
                }
            };
        </script>
        
        <div id="signinButton">
            <span class="g-signin" data-scope="{{ plus_scope }}"
                                   data-clientid="{{ plus_id }}"
                                   data-redirecturi="{% url 'user:passet' %}"
                                   data-accesstype="offline"
                                   data-cookiepolicy="single_host_origin"
                                   data-callback="signInCallback">
            </span>
        </div>
        
        <form id="google-plus" method="post" action="{% url 'social:complete' "google-plus" %}" style="display:none;">
            {% csrf_token %}
            <input id="at" type="hidden" name="access_token" value="" />
            <input id="code" type="hidden" name="code" value="" />
        </form>
    
    {% comment %}
    
        End test
        
    {% endcomment %}
    
    {% comment %}
    
        Testujemy Twitter Auth i LinkedIn login
        
    {% endcomment %}
    
        <a href="{% url 'social:begin' 'twitter' %}"><img src="google.jpg"></a>
        
        <a href="{% url 'social:begin' 'linkedin' %}"><img src="google.jpg"></a>
    
    {% comment %}
    
        End test
        
    {% endcomment %}

    <div class="login-form">
        <h1 class="login-form-header">{% trans "Sign In" %}</h1>
        <div class="login-form-body">
            <div class="login-social row">
                <div class="login-facebook col-sm-4">
                    <a href="{% url 'social:begin' 'facebook' %}"><img src="facebook.jpg"></a>
                </div>
                <div class="login-twitter col-sm-4">
                    <a href="#"><img src="twitter.jpg"></a>
                </div>
                <div class="login-google col-sm-4">
                    <a href="{% url 'social:begin' 'google' %}"><img src="google.jpg"></a>
                </div>
            </div>
            <form action="" method="post">
                <div class="input-section row">
                    <div class="col-sm-12">
                                    
                                    {{ form.errors }}
                                    <form class="form-horizontal" action="{% url 'user:login' %}" method="post">
                                        {% csrf_token %}
                                        {{ form }}
                                        <div class="submit-section row">
                                            <div>
                                                
                                                <a href="{% url 'user:passreset' %}"> {% trans "Forgot password" %}</a>
                                            </div>
                                            <div>
                                                <input type="submit" value="{% trans "Login" %}">
                                            </div>
                                        </div>
                                    </form>
                                    <a href="{% url 'user:register' %}">Don't have account?</a>
                                </div>
                            </div>
                            
                        </form>
                    </div>
                </div>
            </div>

{% endblock %}
