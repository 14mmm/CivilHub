{% extends 'places_core/base.html' %}
{% load staticfiles %}{% load i18n %}

{% block require_scripts %}
<script data-main="{% static 'places_core' %}/js/src/userspace-form.js" src="{% static 'places_core' %}/includes/require/require.js"></script>
{% endblock %}

{% block content %}

{% for error in errors %}
    {{ error }}
{% endfor %}
{% if user.is_authenticated %}

<div class="row">
    <div class="col-sm-3">
        <div class=" sidebar">
            <div class="sidebar-content">
                <img src="{{ profile.avatar.url }}" alt="Avatar" class="user-thumb" />
                <ul>
                    <li><a href="#" class="simple-tabs-link" data-target="tab-1">{% trans "Profile summary" %}</a></li>
                    <li><a href="#" class="simple-tabs-link" data-target="tab-2">{% trans "Change password" %}</a></li>
                    <li><a href="#" class="simple-tabs-link" data-target="tab-3">{% trans "Change avatar" %}</a></li>
                </ul>
                <p>{% trans "Points" %}: {{ profile.rank_pts }}</p>
                <ul>
                {% for badge in profile.badges.all %}
                    <li><img src="{{ badge.thumbnail.url }}" alt="{{ badge.name }}" class="user-badge-thumb" title="{{ badge.name}} - {{ badge.description | escape }}" /></li>
                {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-9">
        <div class="main-content">
            <div class="simple-tabs" id="user-profile-tabs">
                <div class="simple-tabs-tab active" id="tab-1">
                    <form id="user-profile-form" class="form-horizontal" method="post" action="{% url 'user:save_settings' %}">
                        {% csrf_token %}
                        {{ form.as_p }}
                        <div class="form-group">
                            <div class="col-sm-2">&nbsp;</div>
                            <div class="col-sm-10">
                                <button type="submit" class="btn btn-primary">{% trans "Save changes" %}</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="simple-tabs-tab" id="tab-2">
                    <form id="user-password-form" class="form-horizontal" method="post" action="{% url 'user:chpass' %}">
                        {% csrf_token %}
                        {{ passform.as_p }}
                        <div class="form-group">
                            <div class="col-sm-2">&nbsp;</div>
                            <div class="col-sm-10">
                                <button type="submit" class="btn btn-primary">{% trans "Save changes" %}</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="simple-tabs-tab" id="tab-3">
                    <form id="upload-avatar-form" class="form-horizontal" role="form" enctype="multipart/form-data" method="post" action="{% url 'user:upload_avatar' %}">
                        {% csrf_token %}
                        {{ avatar_form.as_p }}
                        <div class="form-group">
                            <label class="control-label col-sm-2">&nbsp;</label>
                            <div class="col-sm-10">
                                <button type="submit" class="btn btn-primary submit-btn">{% trans "Save" %}</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% else %}
    <p class="custom-booklike">{% trans "You are not allowed to visit this page. Sorry." %}</p>
{% endif %}
{% endblock %}
