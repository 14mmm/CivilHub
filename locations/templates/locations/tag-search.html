{% extends 'locations/index.html' %}
{% load staticfiles %}{% load i18n %}

{% block content %}
<div class="col-sm-9">
    <ul>
    {% for item in items %}
        <li><a href="{{ item.get_absolute_url }}">{{ item }}</a></li>
    {% endfor %}
    </ul>
</div>
{% endblock %}

{% block sidebar %}
<div class="col-sm-3">
    <ul class="sidebar-right">
        
    </ul>
    <div class="tags">
        <ul>
        {% for tag, counter in tags %}
            <li class="tag-entry" data-counter="{{ counter }}"><a href="{% url 'locations:tag_search' slug=location.slug tag=tag %}">{{ tag }}</a></li>
        {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}

{% block footer_scripts %}
<script>
(function ($) {
    "use strict";
    var max_counter = 0,
        i = 0,
        min_counter, avg;

    $('.tags > ul > li').each(function () {
        // Zbieramy wartości counterów dla każdego taga.
        var count = parseInt($(this).attr('data-counter'), 10);
        if (count > max_counter) {
            max_counter = count;
        }
        if (min_counter == undefined || count < min_counter) {
            min_counter = count;
        }
        i++
    });

    $('.tags > ul > li').each(function () {
        // Kolejna pętla - przyporządkujemy klasy na podstawie
        // zebranych wcześniej wartości.
        var count = parseInt($(this).attr('data-counter'), 10);
        
        if (count <= max_counter / 5) {
            $(this).addClass('tag1');
        } else if (count <= max_counter / 4) {
            $(this).addClass('tag2');
        } else if (count <= max_counter / 3) {
            $(this).addClass('tag3');
        } else if (count <= max_counter / 2) {
            $(this).addClass('tag4');
        } else {
            $(this).addClass('tag5');
        }
    });

})(jQuery);
</script>
{% endblock %}