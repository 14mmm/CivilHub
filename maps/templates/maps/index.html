{% load staticfiles %} {% load i18n %}
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>{% block title %}{{ title | capfirst }}{% endblock %}</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="{% static 'places_core/favicon.png' %}" />
<link href="{% static 'places_core/css/style.min.css' %}" rel="stylesheet">
<link href="{% static 'places_core/css/jquery-ui.css' %}" rel="stylesheet" type="text/css" />

{% comment %}Miejsce na dodatkowe pliki css.{% endcomment %}
{% block extra_styles %}{% endblock %}

<script type="text/javascript" src="{% url 'django.views.i18n.javascript_catalog' %}"></script>
<script src="{% static 'places_core/includes/require/require.js' %}"></script>

{% include 'places_core/navigation.html' %}

<script>
require.config({
    baseUrl: "{% static 'places_core' %}",
    
    urlArgs: "bust=" + (new Date()).getTime(),
    
    waitSeconds: 200,
    
    paths: {
        jquery: 'includes/jquery/jquery',
        bootstrap: 'includes/bootstrap/bootstrap',
        underscore: 'includes/underscore/underscore',
        backbone: 'includes/backbone/backbone',
        common: 'js/common'
    },
    
    shim: {
        underscore: {
            deps: ['jquery'],
            exports: '_'
        },
        
        backbone: {
            deps: ['underscore'],
            exports: 'Backbone'
        },
        
        bootstrap: {
            deps: ['jquery']
        },
        
        tagsinput: {
            deps: ['jquery']
        },
    }
});

require(['jquery', 'common', 'js/maps/mainMap'], function ($) {
    
    window.MEDIA_URL = '/media';
    
    $(document).trigger('load');
    
});
</script>

<div id="map-options-toggle">
    <a id="map-filter-toggle" href="#" title="{% trans "Show options" %}">
        <span class="fa fa-arrow-circle-down"> </span>
    </a>
    {% if user.is_authenticated %}
    <a id="map-follow-toggle" href="#" title="{% trans "Only followed locations" %}">
        <span class="fa fa-circle-o"> </span>
    </a>
    {% endif %}
</div>
<nav id="map-options-panel" role="navigation">
    <ul>
        <li>Places <input type="checkbox" data-target="location" class="map-filter-toggle" checked="checked" /></li>
        <li>Ideas <input type="checkbox" data-target="idea" class="map-filter-toggle" checked="checked" /></li>
        <li>Polls <input type="checkbox" data-target="poll" class="map-filter-toggle" checked="checked" /></li>
        <li>Discussions <input type="checkbox" data-target="discussion" class="map-filter-toggle" checked="checked" /></li>
        <li>News <input type="checkbox" data-target="news" class="map-filter-toggle" checked="checked" /></li>
    </ul>
</nav>

<div id="map"></div>

<script type="text/template" id="user-popup-tpl">
    <div class="user-popup-avatar">
        <img src="<%= avatar %>" alt="<%= username %>" />
    </div>
    <div class="user-popup-details">
        <span class="fa fa-times-circle-o user-popup-close"> </span>
        <p class="user-popup-personals">
            <a href="<%= user_link %>"><%= fullname %></a><br />
            <%= rank_pts %> {% trans 'pts' %}
        </p>
        <p>
            <% for (var i = 0; i < follows.length; i++) { %>
                <%= follows[i] %>,&nbsp;
            <% } %>
        </p>
    </div>
</script>

</body>
</html>